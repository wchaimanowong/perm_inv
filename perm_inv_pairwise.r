
##Hollander-Wolfe-Chicken Example 3.11 Insulin Clearance in Kidney Transplants
#x<-c(61.4,63.3,63.7,80,77.3,84,105, 70.8,89.2,65.8,67.1,87.3,85.1)
#y<-c(70.8,89.2,65.8,67.1,87.3,85.1,88.1, 61.4,63.3,63.7,80,77.3,84)

# AA

x0 <- c(0.05479455, 0.20890409, 0.11643834, 0.10616445, 0.22260271,
        0.10273971, 0.17465754, 0.21232882, 0.17123297, 0.2431508 ,
        0.31164387, 0.28082192, 0.18835616, 0.15753435, 0.28424665,
        0.1917809 , 0.03767128, 0.2431508 , 0.19520546, 0.3767124 ,
        0.22602744, 0.0513699 , 0.22602744, 0.41780826, 0.15753435,
        0.22602744, 0.12328764, 0.23630132, 0.14041099, 0.26369873,
        0.36643836, 0.21917813, 0.22260271, 0.20890409, 0.36643836,
        0.260274  , 0.11986307, 0.12328764, 0.17808227, 0.0890411 ,
        0.10958903, 0.12671238, 0.        , 0.05479455, 0.21917813,
        0.16095892, 0.03424663, 0.07534248, 0.20205478, 0.24657537,
        0.15410961, 0.22602744, 0.20547952, 0.35273972, 0.14726031,
        0.15068488, 0.0513699 , 0.07876722, 0.1917809 , 0.09246583,
        0.12671238, 0.14726031, 0.22602744, 0.1986302 , 0.17465754,
        0.2431508 , 0.11301376, 0.23287675, 0.51712334, 0.26712328,
        0.34589043, 0.2431508 , 0.3321918 , 0.52397263, 0.3253425 ,
        0.10616445, 0.32876724, 0.16095892, 0.21917813, 0.13698626,
        0.31164387, 0.09931514, 0.15068488, 0.03424663, 0.34931517,
        0.17808227, 0.3321918 , 0.4657534 , 0.4006849 , 0.06849317,
        0.20547952, 0.1986302 , 0.0958904 , 0.40410963, 0.4657534 ,
        0.29452053, 0.13356169, 0.2500001 , 0.09931514, 0.21232882,
        0.45547953, 0.35273972, 0.44178092, 0.46917814, 0.4486302 ,
        0.421233  , 0.52054805, 0.3253425 , 0.52739733, 0.36643836,
        0.52397263, 0.34589043, 0.17808227, 0.36643836, 0.42465755,
        0.20547952, 0.3938356 , 0.33561656, 0.48287678, 0.48630133,
        0.47260273, 0.54794526, 0.3835617 , 0.49315065, 0.44178092,
        0.35273972, 0.48630133, 0.31164387, 0.49315065, 0.25342467,
        0.45547953, 0.41095895, 0.46917814, 0.37328765, 0.23972605,
        0.3561645 , 0.11301376, 0.36643836, 0.34931517, 0.3184932 ,
        0.2568494 , 0.31164387, 0.3869863 , 0.48287678, 0.44178092,
        0.4486302 , 0.39041102, 0.36643836, 0.20890409, 0.36301377,
        0.38013697, 0.3869863 , 0.13698626, 0.44520548, 0.23972605,
        0.37328765, 0.45547953, 0.3698631 , 0.41095895, 0.57534254,
        0.7294521 , 0.41438368, 0.57534254, 0.4657534 , 0.2876712 ,
        1.        , 0.35273972, 0.52739733, 0.45547953, 0.30136985,
        0.41095895, 0.4075342 , 0.5787671 , 0.6130138 , 0.421233  ,
        0.5821918 , 0.4486302 , 0.39726034, 0.41438368, 0.4486302 ,
        0.64726037, 0.28424665, 0.38013697, 0.3938356 , 0.52739733,
        0.4657534 , 0.510274  , 0.41780826, 0.41438368, 0.421233  ,
        0.4965754 , 0.4383562 , 0.42465755, 0.28424665, 0.4486302 ,
        0.52739733, 0.36301377, 0.3767124 , 0.6369863 , 0.421233  ,
        0.4006849 , 0.541096 )

x1 <- c(0.38181818, 0.45454547, 0.15454546, 0.1818182 , 0.31818184,
        0.10000002, 0.1818182 , 0.2181818 , 0.50909084, 0.10000002,
        0.1818182 , 0.36363637, 0.4090909 , 0.26363635, 0.24545455,
        0.22727275, 0.36363637, 0.45454547, 0.43636367, 0.32727274,
        0.2181818 , 0.        , 0.56363636, 0.28181818, 0.22727275,
        0.2090909 , 0.22727275, 0.3909091 , 0.38181818, 0.29999998,
        0.28181818, 0.6181818 , 0.29999998, 0.23636365, 0.36363637,
        0.90909094, 0.24545455, 0.3909091 , 0.28181818, 0.22727275,
        0.25454545, 0.15454546, 0.29999998, 0.2       , 0.58181816,
        0.6636364 , 0.27272728, 0.52727276, 0.57272726, 0.16363636,
        0.6727272 , 0.690909  , 0.54545456, 0.4636363 , 0.32727274,
        0.4636363 , 0.29999998, 0.47272727, 0.2       , 0.23636365,
        0.14545456, 0.43636367, 0.45454547, 0.22727275, 0.1818182 ,
        0.16363636, 0.33636364, 0.56363636, 0.56363636, 0.22727275,
        0.31818184, 0.5181818 , 0.34545454, 0.54545456, 0.38181818,
        0.36363637, 0.3909091 , 0.32727274, 0.25454545, 0.29090908,
        0.32727274, 0.28181818, 0.29999998, 0.24545455, 0.3909091 ,
        0.31818184, 0.35454544, 0.4454545 , 0.4090909 , 0.08181817,
        0.06363637, 0.41818187, 0.29999998, 0.28181818, 0.35454544,
        0.28181818, 0.5181818 , 0.15454546, 0.14545456, 0.28181818,
        0.34545454, 0.3909091 , 0.12727271, 0.07272727, 0.30909088,
        0.34545454, 0.24545455, 0.4818182 , 0.29999998, 0.13636366,
        0.17272726, 0.26363635, 0.09090912, 0.4454545 , 0.34545454,
        0.1818182 , 0.23636365, 0.54545456, 0.31818184, 0.4636363 ,
        0.29090908, 0.31818184, 0.1909091 , 0.38181818, 0.6181818 ,
        0.15454546, 0.24545455, 0.4272727 , 0.35454544, 0.23636365,
        0.22727275, 0.30909088, 0.4272727 , 0.38181818, 0.5363636 ,
        0.45454547, 0.50909084, 0.3727273 , 0.28181818, 0.30909088,
        0.2090909 , 0.35454544, 0.36363637, 0.38181818, 0.50909084,
        0.57272726, 0.27272728, 0.27272728, 0.10909092, 0.05454547,
        0.5181818 , 0.36363637, 0.10909092, 0.25454545, 0.25454545,
        0.22727275, 0.06363637, 0.09090912, 0.4454545 , 0.11818182,
        0.28181818, 0.50909084, 0.26363635, 0.4636363 , 0.5181818 ,
        0.34545454, 0.29999998, 0.3909091 , 0.11818182, 0.13636366,
        0.17272726, 0.35454544, 0.23636365, 0.41818187, 0.29999998,
        0.28181818, 0.54545456, 0.45454547, 0.50909084, 0.49090907,
        0.6818182 , 0.52727276, 0.62727267, 0.38181818, 0.60909086,
        0.8727272 , 0.8545454 , 0.25454545, 0.59090906, 0.38181818,
        0.3727273 , 0.47272727, 0.24545455, 1.        , 0.33636364,
        0.26363635, 0.50909084, 0.3909091 , 0.45454547, 0.28181818,
        0.5       , 0.27272728)

x2 <- c(0.06722683, 0.09663863, 0.0210084 , 0.05882344, 0.23529406,
        0.06302521, 0.15546206, 0.16806723, 0.21848728, 0.23949568,
        0.23109244, 0.3319327 , 0.23109244, 0.21428566, 0.32773107,
        0.18487386, 0.07142845, 0.32773107, 0.24789907, 0.34033608,
        0.13865544, 0.04201681, 0.23529406, 0.3739495 , 0.22268905,
        0.21848728, 0.16386546, 0.24789907, 0.10504202, 0.2899159 ,
        0.3739495 , 0.28571427, 0.2815125 , 0.21848728, 0.3445377 ,
        0.26470587, 0.08823523, 0.06722683, 0.07563023, 0.11764703,
        0.02941164, 0.06302521, 0.02521002, 0.01680663, 0.23109244,
        0.07563023, 0.        , 0.07563023, 0.10084024, 0.12184865,
        0.15126045, 0.15966384, 0.18907563, 0.24789907, 0.10084024,
        0.07142845, 0.10504202, 0.07563023, 0.23109244, 0.15126045,
        0.12605043, 0.09663863, 0.26470587, 0.25630248, 0.21848728,
        0.21008404, 0.15966384, 0.02521002, 0.47058812, 0.26050407,
        0.28571427, 0.15966384, 0.19747888, 0.4663865 , 0.3319327 ,
        0.11764703, 0.29411766, 0.3445377 , 0.2815125 , 0.13445365,
        0.31932768, 0.17647046, 0.09663863, 0.12605043, 0.30672267,
        0.19747888, 0.3109243 , 0.3949579 , 0.36974788, 0.02941164,
        0.20588227, 0.16386546, 0.07983184, 0.3739495 , 0.3529411 ,
        0.21008404, 0.13025203, 0.20168065, 0.00420162, 0.2899159 ,
        0.4579831 , 0.39075628, 0.44957972, 0.37815127, 0.4285713 ,
        0.3865545 , 0.4873949 , 0.4033613 , 0.5336133 , 0.37815127,
        0.4999999 , 0.39075628, 0.23949568, 0.3319327 , 0.34033608,
        0.27731088, 0.39915967, 0.29831928, 0.3613445 , 0.4873949 ,
        0.39915967, 0.57142854, 0.43277308, 0.4453781 , 0.37815127,
        0.3319327 , 0.44957972, 0.4033613 , 0.44957972, 0.35714287,
        0.4285713 , 0.3949579 , 0.5042017 , 0.23949568, 0.20168065,
        0.4369747 , 0.18487386, 0.31932768, 0.3529411 , 0.2899159 ,
        0.2815125 , 0.3235293 , 0.43277308, 0.4873949 , 0.4369747 ,
        0.5168067 , 0.41176468, 0.4159663 , 0.34873948, 0.37815127,
        0.4369747 , 0.39075628, 0.22268905, 0.3949579 , 0.26470587,
        0.4033613 , 0.3445377 , 0.4075629 , 0.4579831 , 0.5672269 ,
        0.55462176, 0.4243697 , 0.5168067 , 0.35714287, 0.29411766,
        1.        , 0.3319327 , 0.5210083 , 0.3949579 , 0.29831928,
        0.3865545 , 0.23109244, 0.4957983 , 0.5798319 , 0.36974788,
        0.51260495, 0.39915967, 0.3949579 , 0.4243697 , 0.4453781 ,
        0.61344534, 0.26050407, 0.3823529 , 0.3613445 , 0.4579831 ,
        0.49159652, 0.5084033 , 0.3235293 , 0.4453781 , 0.3235293 ,
        0.4789915 , 0.4369747 , 0.42016807, 0.3739495 , 0.4957983 ,
        0.58403355, 0.46218488, 0.4075629 , 0.60084033, 0.28571427,
        0.29831928, 0.4243697 )

# Wine Quality

y0 <- c(0.        , 0.13000003, 0.21999998, 0.19000001, 0.66      ,
        0.33999997, 0.29000002, 0.33      , 0.55      , 0.26999998,
        0.59      , 0.05999999, 0.2       , 0.38000003, 0.14000002,
        0.53999996, 0.57      , 0.42      , 0.03000002, 0.4       ,
        0.36999997, 0.35      , 0.16999999, 0.66999996, 0.36999997,
        0.21      , 0.28000003, 0.24000001, 0.75      , 0.26999998,
        0.41000003, 0.46999997, 0.66      , 0.36999997, 0.28000003,
        0.4       , 0.41000003, 0.05999999, 0.11999998, 0.01999998,
        0.83000004, 0.38999996, 0.21999998, 0.61      , 0.28000003,
        0.48999995, 0.5       , 0.38000003, 0.43      , 0.68999994,
        0.57      , 0.18000002, 0.2       , 0.04000001, 0.2       ,
        0.26      , 0.63      , 0.16999999, 0.24000001, 0.2       ,
        0.36000004, 0.14000002, 0.76000005, 0.53999996, 0.2       ,
        0.48000002, 0.14000002, 0.2       , 0.26      , 0.51000005,
        1.        , 0.28000003, 0.18000002, 0.75      , 0.55      ,
        0.42      , 0.21      , 0.38000003, 0.53999996, 0.4       ,
        0.18000002, 0.62      , 0.19000001, 0.56000006, 0.18000002,
        0.82      , 0.53000003, 0.16999999, 0.33      , 0.32      ,
        0.21      , 0.25      , 0.19000001, 0.7       , 0.53999996,
        0.2       , 0.4       , 0.10999999, 0.38000003, 0.31000003,
        0.26      , 0.3       , 0.23000002, 0.29000002, 0.53000003,
        0.15      , 0.52      , 0.28000003, 0.21999998, 0.05999999,
        0.14000002, 0.32      , 0.05999999, 0.15      , 0.26      ,
        0.19000001, 0.18000002, 0.52      , 0.14000002, 0.21      ,
        0.3       , 0.78000003, 0.23000002, 0.33      , 0.55      ,
        0.14000002, 0.36000004, 0.38000003, 0.38000003, 0.16      ,
        0.21999998, 0.21999998, 0.21999998, 0.48999995, 0.33      ,
        0.16      , 0.2       , 0.59      , 0.64      , 0.04000001,
        0.32      , 0.14000002, 0.29000002, 0.16999999, 0.53999996,
        0.21      , 0.28000003, 0.28000003, 0.41000003, 0.43      ,
        0.66      , 0.23000002, 0.23000002, 0.43999997, 0.52      ,
        0.28000003, 0.41000003, 0.41000003, 0.32      , 0.24000001,
        0.31000003, 0.05999999, 0.48999995, 0.84      , 0.24000001,
        0.41000003, 0.24000001, 0.25      , 0.4       , 0.35      ,
        0.15      , 0.21999998, 0.65      , 0.5       , 0.13000003,
        0.53999996, 0.16      , 0.53999996, 0.5       , 0.26999998,
        0.51000005, 0.2       , 0.88      , 0.25      , 0.38000003,
        0.26999998, 0.65      , 0.23000002, 0.21999998, 0.3       ,
        0.53000003, 0.4       , 0.59      , 0.65      , 0.36999997,
        0.26      , 0.4       , 0.26      , 0.23000002, 0.46999997,
        0.56000006, 0.24000001)

y1 <- c(0.29268292, 0.49999997, 0.45121944, 0.70731705, 0.19512193,
        0.2195122 , 0.40243903, 0.60365844, 0.28048778, 0.6463414 ,
        0.28048778, 0.55487806, 0.6463414 , 0.29268292, 0.58536583,
        0.26829267, 0.2317073 , 0.45121944, 0.67682916, 0.32926828,
        0.15853657, 0.02439026, 0.        , 0.3536585 , 0.30487803,
        0.36585364, 0.8780488 , 0.24390244, 0.26829267, 0.6158536 ,
        0.2195122 , 0.6463414 , 0.3414634 , 0.6280487 , 0.5365854 ,
        0.37804875, 0.74999994, 0.92073166, 0.5731707 , 0.5914634 ,
        0.2195122 , 0.53048784, 0.5731707 , 0.18292682, 0.43902433,
        0.5731707 , 0.19512193, 0.5487805 , 0.24390244, 0.26829267,
        0.43902433, 0.7987804 , 0.07317073, 0.70731705, 0.32926828,
        0.31707314, 0.25609756, 0.847561  , 0.43902433, 0.6463414 ,
        0.07317073, 0.28048778, 0.26829267, 0.12195121, 0.41463414,
        0.42682922, 0.6463414 , 0.6463414 , 0.30487803, 0.9451219 ,
        0.0609756 , 0.9146341 , 0.41463414, 0.14634146, 0.42682922,
        0.7256097 , 0.52439016, 0.31707314, 0.43902433, 0.24390244,
        0.6463414 , 0.29268292, 0.47560975, 0.41463414, 0.76219505,
        0.26829267, 0.52439016, 0.46341464, 0.59756094, 0.20731708,
        0.5609756 , 0.43902433, 0.48780486, 0.25609756, 0.3414634 ,
        0.49999997, 0.3536585 , 0.66463405, 0.47560975, 0.86585367,
        0.7560975 , 0.02439026, 0.17682926, 0.49999997, 0.41463414,
        0.43902433, 0.20731708, 0.45121944, 0.5487805 , 0.60975605,
        0.18292682, 0.26829267, 0.46341464, 0.45121944, 0.29268292,
        0.73780483, 0.59756094, 0.2195122 , 0.45121944, 0.24390244,
        0.52439016, 0.55487806, 0.39024386, 0.59756094, 0.52439016,
        0.5731707 , 0.40243903, 0.52439016, 0.43902433, 0.97560966,
        0.5731707 , 0.59756094, 0.24390244, 0.41463414, 0.48780486,
        0.3414634 , 0.7134146 , 0.0609756 , 0.12195121, 0.8231706 ,
        0.14634146, 0.49999997, 0.2195122 , 0.30487803, 0.47560975,
        0.59756094, 0.5365854 , 0.5365854 , 0.14634146, 0.29268292,
        0.30487803, 1.        , 0.2317073 , 0.52439016, 0.24390244,
        0.80487794, 0.43902433, 0.25609756, 0.12195121, 0.37804875,
        0.4695122 , 0.18292682, 0.45121944, 0.13414635, 0.9817072 ,
        0.41463414, 0.76219505, 0.5731707 , 0.6463414 , 0.60975605,
        0.45121944, 0.24390244, 0.17073171, 0.19512193, 1.        ,
        0.12195121, 0.5487805 , 0.20731708, 0.2317073 , 0.08536585,
        0.26829267, 0.99390244, 0.40243903, 0.7439024 , 0.39024386,
        0.74999994, 0.2317073 , 0.70731705, 0.30487803, 0.18292682,
        0.32926828, 0.80487794, 0.25609756, 0.18902437, 0.82926816,
        0.70731705, 0.5365854 , 0.32926828, 0.17682926, 0.31707314,
        0.24390244, 0.2317073 )

y2 <- c(0.64102566, 0.35897437, 0.17948718, 0.03846154, 0.70512825,
        0.53846157, 0.41025642, 0.15384616, 0.5897436 , 0.6282052 ,
        0.6025641 , 0.        , 0.08974359, 0.51282054, 0.26923078,
        0.5897436 , 0.67948717, 0.30769232, 0.24358974, 0.43589747,
        0.6666667 , 0.65384614, 0.82051283, 0.80769235, 0.525641  ,
        0.17948718, 0.        , 0.38461542, 0.76923084, 0.        ,
        0.53846157, 0.41025642, 0.82051283, 0.12820514, 0.33333334,
        0.3974359 , 0.2820513 , 0.        , 0.3974359 , 0.        ,
        0.6666667 , 0.525641  , 0.        , 0.6282052 , 0.32051283,
        0.30769232, 0.75641024, 0.24358974, 0.5       , 0.65384614,
        0.4871795 , 0.        , 0.38461542, 0.        , 0.4615385 ,
        0.32051283, 0.525641  , 0.02564103, 0.16666667, 0.1025641 ,
        0.4615385 , 0.42307696, 0.8461539 , 0.61538464, 0.32051283,
        0.24358974, 0.        , 0.08974359, 0.6282052 , 0.2820513 ,
        0.5641026 , 0.08974359, 0.14102565, 0.6923078 , 0.82051283,
        0.23076925, 0.01282051, 0.26923078, 0.5769231 , 0.6666667 ,
        0.        , 0.64102566, 0.19230771, 0.5769231 , 0.        ,
        0.70512825, 0.53846157, 0.16666667, 0.12820514, 0.41025642,
        0.07692308, 0.20512821, 0.03846154, 0.974359  , 0.53846157,
        0.        , 0.6282052 , 0.12820514, 0.05128205, 0.        ,
        0.        , 0.474359  , 0.5       , 0.3974359 , 0.53846157,
        0.14102565, 0.5897436 , 0.05128205, 0.1025641 , 0.        ,
        0.11538462, 0.41025642, 0.05128205, 0.07692308, 0.37179488,
        0.02564103, 0.02564103, 0.61538464, 0.11538462, 0.38461542,
        0.20512821, 0.8461539 , 0.41025642, 0.12820514, 0.6282052 ,
        0.26923078, 0.35897437, 0.23076925, 0.43589747, 0.        ,
        0.        , 0.02564103, 0.5897436 , 0.30769232, 0.2820513 ,
        0.19230771, 0.15384616, 0.6282052 , 0.5641026 , 0.1025641 ,
        0.76923084, 0.15384616, 0.4615385 , 0.5512821 , 0.2948718 ,
        0.23076925, 0.33333334, 0.33333334, 0.5897436 , 0.6282052 ,
        0.74358976, 0.06410257, 0.30769232, 0.17948718, 0.82051283,
        0.37179488, 0.42307696, 0.41025642, 0.43589747, 0.5897436 ,
        0.23076925, 1.        , 0.7307693 , 0.7948718 , 0.        ,
        0.38461542, 0.24358974, 0.15384616, 0.        , 0.25641027,
        0.07692308, 0.5897436 , 0.76923084, 0.75641024, 0.01282051,
        0.61538464, 0.01282051, 0.80769235, 0.5769231 , 0.474359  ,
        0.64102566, 0.05128205, 0.8589744 , 0.25641027, 0.525641  ,
        0.53846157, 0.6282052 , 0.1025641 , 0.38461542, 0.5769231 ,
        0.5641026 , 0.17948718, 0.74358976, 0.6923078 , 0.        ,
        0.        , 0.37179488, 0.37179488, 0.5       , 0.5897436 ,
        0.76923084, 0.42307696)

alpha <- 0.01

##Exact p-value (AA)
p01 <- pHollBivSym(x0,x1)$p.val
p12 <- pHollBivSym(x1,x2)$p.val
p02 <- pHollBivSym(x0,x2)$p.val

reject <- ((p01 < alpha/3) || (p12 < alpha/3) || (p02 < alpha/3)) 
print(paste("p01 = ", as.character(p01), "p12 = ", as.character(p12), "p02 = ", as.character(p02), "Reject H0 = ", as.character(reject)))

##Exact p-value (Wine Quality)
p01 <- pHollBivSym(y0,y1)$p.val
p12 <- pHollBivSym(y1,y2)$p.val
p02 <- pHollBivSym(y0,y2)$p.val

reject <- ((p01 < alpha/3) || (p12 < alpha/3) || (p02 < alpha/3)) 
print(paste("p01 = ", as.character(p01), "p12 = ", as.character(p12), "p02 = ", as.character(p02), "Reject H0 = ", as.character(reject)))
